<div class="page">
    <div class="toolbar">
        <h2 class="title">Pathfinding Visualiser</h2>
    </div>

    <div class="legend-container">
        <p>ðŸŸ¦ Expanded</p>
        <p>ðŸŸ¥ In Agenda</p>
        <p>ðŸŸ¨ Final Path</p>
        <p>â¬› Barrier</p>
        <p>â¬œ Empty</p>
    </div>

    <div class="content-container">
        <div class="animation-menu">
            <div class="range-container">
                <p>Set Animation Delay</p>
                <input type="range" class="range"/>
                <p>1000ms</p>
            </div>

            <div class="media-control-container">
                <img
                    (click)="domUpdatesService.newAnimationIndexAction$.next({ kind: 'Decrement' })"
                    id="step-back-btn"
                    class="media-control-symbol"
                    src="./assets/step-back-button.png"
                />

                <img
                    *ngIf="(animationRunningService.stream$ | async) === false"
                    (click)="domUpdatesService.setAnimationRunning$.next(true)"
                    id="play-btn"
                    class="media-control-symbol"
                    src="./assets/play-button.png"
                />

                <img
                    *ngIf="(animationRunningService.stream$ | async) === true"
                    (click)="domUpdatesService.setAnimationRunning$.next(false)"
                    id="pause-btn"
                    class="media-control-symbol"
                    src="./assets/pause-button.png"
                />

                <img
                    (click)="domUpdatesService.newAnimationIndexAction$.next({ kind: 'Increment' })"
                    id="step-forward-btn"
                    class="media-control-symbol"
                    src="./assets/step-forward-button.png"
                />
            </div>

            <div class="range-container">
                <p>Step Through Frames</p>
                <input 
                    type="range" 
                    class="range" 
                    [value]="(animationIndexService.stream$ | async)!" 
                    min="0"
                    [max]="(animationFramesForMultipleAlgosService.stream$ | async)!.lengthOfFramesForEachAlgo - 1"
                    (input)="updateAnimationIndexFromRange($event)"
                />
                <p>{{(animationIndexService.stream$ | async)! + 1}} / {{(numberOfAnimationFramesDisplay$ | async)!}}</p>
            </div>
        </div>

        <div class="grids-container">
            <div *ngFor="let algo of (pathfindingAlgosService.stream$ | async)!">
                <app-grid    
                    [weightGrid]="(weightGridService.stream$ | async)!" 
                    [barrierGrid]="(barrierGridService.stream$ | async)!" 
                    [startPos]="(startPosService.stream$ | async)!" 
                    [goalPos]="(goalPosService.stream$ | async)!" 
                    [typeOfDataDisplayedOnTile]="(domUpdatesService.setTypeOfDataDisplayedOnTile$ | async)!" 
                    [willDisplayTooltipOnMouseOver]="false" 
                    [animationFrame]="(currentAnimationFrameForMultipleAlgosService.stream$ | async)!.get(algo)!" 
                    [heuristicDistFromGoalGrid]="(heuristicDistGridService.stream$ | async)!"
                    [gridDimensions]="(gridDimensionsService.stream$ | async)!"
                    (activate)="domUpdatesService.activateTile$.next($event)"
                    (drag)="domUpdatesService.drag$.next($event)" 
                    (drop)="domUpdatesService.drop$.next($event)" 
                >
                </app-grid>
            </div>
        </div>
    </div>

    <div class="sidebar">
        <div class="sidebar-grouping">
            <h2>Configure Algorithm</h2>
            <div class="sidebar-button-grouping">
                <button>Visit Order</button>
            </div>
        </div>
        <div class="sidebar-grouping">
            <h2>Neighbour Directions</h2>
        </div>
        <div class="sidebar-grouping">
            <h2>Maze Type</h2>
        </div>
        <div class="sidebar-grouping">
            <h2>Grid Options</h2>
            <div class="sidebar-button-grouping">
                <button>Generate Maze</button>
                <button>Clear</button>
                <button>Save</button>
                <button>Load</button>
            </div>
        </div>
        <div class="sidebar-grouping">
            <h2>Obstacle Placed On Tile</h2>
            <div class="radio-button-grouping">
                <span class="radio-button">
                    <input 
                        [checked]="(domUpdatesService.setObstaclePlacedOnTile$ | async) === ObstaclePlacedOnTileOption.RandomWeight"
                        type="radio" 
                        id="random-weight" 
                        name="obstacle-placed-on-tile" 
                        [value]="ObstaclePlacedOnTileOption.RandomWeight"
                        (change)="domUpdatesService.setObstaclePlacedOnTile$.next(ObstaclePlacedOnTileOption.RandomWeight)"
                    />
                    <label for="random-weight">Random Weight</label>
                </span>
                <span class="radio-button">
                    <input
                        [checked]="(domUpdatesService.setObstaclePlacedOnTile$ | async) === ObstaclePlacedOnTileOption.CustomWeight" 
                        type="radio" 
                        id="custom-weight" 
                        name="obstacle-placed-on-tile" 
                        [value]="ObstaclePlacedOnTileOption.CustomWeight"
                        (change)="domUpdatesService.setObstaclePlacedOnTile$.next(ObstaclePlacedOnTileOption.CustomWeight)"
                    />
                    <label for="custom-weight">Custom Weight</label>
                </span>
                <span class="radio-button">
                    <input
                        [checked]="(domUpdatesService.setObstaclePlacedOnTile$ | async) === ObstaclePlacedOnTileOption.Barrier" 
                        type="radio" 
                        id="barrier" 
                        name="obstacle-placed-on-tile" 
                        [value]="ObstaclePlacedOnTileOption.Barrier"
                        (change)="domUpdatesService.setObstaclePlacedOnTile$.next(ObstaclePlacedOnTileOption.Barrier)"
                    />
                    <label for="barrier">Barrier</label>
                </span>     
            </div>
        </div>
        <div class="sidebar-grouping">
            <h2>Info Displayed On Tile</h2>
        </div>
        <div class="sidebar-grouping">
            <h2>Configure Multiple Grids</h2>
            <div class="sidebar-button-grouping">
                <button 
                    *ngIf="(shouldRenderAddGridButton$ | async) === true"
                    (click)="domUpdatesService.newPathfindingAlgosAction$.next({ kind: 'Add' })"
                >
                    Add
                </button>
                <button (click)="domUpdatesService.newPathfindingAlgosAction$.next({ kind: 'Reset' })">
                    Reset
                </button>
            </div>
        </div>
    </div>
</div>
